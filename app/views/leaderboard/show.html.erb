<div class="relative min-h-screen flex flex-col p-6 pb-28">
  <!-- Header -->
  <header class="flex items-center justify-between mb-8">
    <button class="text-2xl text-gray-400 hover:text-white">
      <i class="fas fa-cog"></i>
    </button>
    <h1 class="text-lg font-semibold text-text-primary-light dark:text-text-primary-dark">Friends Leaderboard</h1>
    <button class="text-xl text-gray-400 hover:text-white">
      <i class="fas fa-share-alt"></i>
    </button>
  </header>

  <main class="flex-grow">
    <!-- Page Title -->
    <section class="mb-6">
      <h2 class="text-4xl font-bold text-text-primary-light dark:text-text-primary-dark">World Cup Sweepstake</h2>
    </section>

    <!-- Ben Motson Insights -->
    <section class="insights-box">
      <div class="insights-header">
        <i class="fas fa-microphone insights-icon"></i>
        <h3 class="insights-title">Ben Motson's Analysis</h3>
      </div>
      <p class="insights-text">
        The competition is heating up! <%= @leaderboard.first&.friend&.name || "The leader" %> is in first place with <%= @leaderboard.first&.total_points&.to_i || 0 %> points.
      </p>
    </section>

    <!-- Leaderboard List -->
    <section>
      <div class="space-y-2">
        <% @leaderboard.each_with_index do |group, index| %>
          <% next unless group.friend %>

          <article class="leaderboard-entry">
            <!-- Rank Icon/Number -->
            <div class="leaderboard-rank">
              <% if index == 0 %>
                <i class="fas fa-star text-2xl text-yellow-400"></i>
              <% elsif index == 1 %>
                <i class="fas fa-medal text-2xl text-gray-400"></i>
              <% elsif index == 2 %>
                <i class="fas fa-award text-2xl text-orange-600"></i>
              <% else %>
                <span class="leaderboard-rank-number"><%= index + 1 %></span>
              <% end %>
            </div>

            <!-- Profile Picture -->
            <% if group.friend.profile_picture_url.present? %>
              <%= image_tag group.friend.profile_picture_url, alt: group.friend.name, class: "leaderboard-avatar" %>
            <% else %>
              <div class="leaderboard-avatar-placeholder">
                <span class="leaderboard-avatar-initial"><%= group.friend.name[0] %></span>
              </div>
            <% end %>

            <!-- Name and Points -->
            <div class="leaderboard-info">
              <p class="leaderboard-name"><%= group.friend.name %></p>
              <p class="leaderboard-points"><%= group.total_points.to_i %> pts</p>

              <!-- Team Flags -->
              <div class="leaderboard-flags">
                <% group.teams.limit(3).each do |team| %>
                  <% if team.flag_url.present? %>
                    <%= image_tag team.flag_url, alt: team.name, class: "leaderboard-flag" %>
                  <% end %>
                <% end %>
                <% if group.teams.count > 3 %>
                  <span class="text-xs text-text-secondary-light dark:text-text-secondary-dark">+<%= group.teams.count - 3 %></span>
                <% end %>
              </div>
            </div>

            <!-- Expand Icon -->
            <div class="ml-2">
              <i class="fas fa-chevron-right text-text-secondary-light dark:text-text-secondary-dark"></i>
            </div>
          </article>
        <% end %>
      </div>
    </section>
  </main>
</div>

<%= render 'layouts/bottom_nav' %>
